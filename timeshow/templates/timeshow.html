<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <title>Time Show</title>

        <meta name="author" content="an9wer">

        <link rel="stylesheet" href="/static/timeshow.css">

        <script src="https://vuejs.org/js/vue.js"></script>
        <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    </head>
    <body>
        <!-- header -->
        <header>
            <h1>Time Show</h1>
        </header>

        <main>
            <template v-for="item in items">
                <article>
                    <section class="datetime">
                        <time>{{ item.datetime }}</time>
                    </section>
                    <section class="mind">
                        {{ item.mind }}
                    </section>
                </article>
            </template>
        </main>

        <!-- footer -->
        <footer>
        </footer>

        <!-- scripts -->
        <script>
            var vm = new Vue({
                el: "main",
                data: {
                    items: [],
                },
            })
            axios.get('/api/load/')
                .then(function (response) {
                    console.log(response.data.items);
                    vm.items = vm.items.concat(response.data.items);
                })
                .catch(function (error) {
                    console.log(error);
                });
        window.onscroll = function(ev) {
            if ((window.innerHeight + window.scrollY) >= document.body.scrollHeight) {
                axios.get('/api/load/')
                    .then(function (response) {
                        console.log(response.data.items);
                        vm.items = vm.items.concat(response.data.items);
                    })
                    .catch(function (error) {
                        console.log(error);
                    });

            }
        }
        </script>
    </body>
</html>
