== Options ==

-   `-t table`: This option specifies the packet matching table  which the
    command should operate on. If the kernel is configured with automatic
    module loading, an attempt will be made to load the appropriate module for
    that table if it is not already there. The tables contain `filter`
    (default), `nat`, `mangle`, `raw` and `security`.

-   `-A chain rule-specification`: Append one or more rules to the end of the
    selected chain. When the source and/or destiation names resolve the more
    than one address, a rule will be added for each possible address
    combination.

-   `-C chain rule-specification`: Check whether a rule matching the
    specification does exist in the selected chain. This command uses the same
    logic as `-D` to find a matching entry, but does not alter the existing
    iptables configuration and uses its exit code to indicate success or
    failure.

-   `-D chain rule-specification|rulenum`: Delete one or more rules from the
    selected chain. There are two verisons of this command: the rule can be
    specified as a number in the chain (starting at 1 for the first rule) or a
    rule to match.

-   `-I chain [rulenum] rule-specification`: Insert one or more rules in the
    selected chain as the given rule number. So, if the rule number is 1, the
    rule or rules are inserted at the head of the chain. This is also the
    default if no rule number is specified.

-   `-R chain rulenum rule-specification`: Replace a rule in the selected
    chain. If the source and/or destination names resolve to multiple address,
    the command will fail. Rule are numbered starting at 1.

-   `-L [chain]`: List all rules in the selected chain. If no chain is selecte,
    all chains are listed. 

-   `-S [chain]`: Print all rules in the selected chain. If no chain is
    selected, all chains are printed like iptables-save.

-   `-F [chain]`: Flush the selected chain. This is equivalent to delete all
    the rules one by one.

-   `-Z [chain [rulenum]]`: Zero the packet and byte counters in all chains, or
    only the given chain, or only the given rule in a chain.

-   `-v`: Verbose output.

-   `-n`: Numeric output. IP address and port numbers will be printed in
    numeric format.

-   `-x`: Expand numbers. Display the exact value of the packet and byte
    counters, instead of only the rounded number in K's (multiples of 1000) M's
    (Multiples of 1000K) or G's (multiples of 1000M). This option is only
    relevant for the `-L` option.

-   `--line-numbers`: When listing rules, add line numbers to the beginning of
    each rule, corresponding to that rule's position in the chain.

== Parameters ==

-   `[!] -p protocol`: The protocol of the rule or of the packet to check. The
    specified protocol can be one of tcp, udp, udplite, icmp, icmpv6, esp, ah,
    sctp, mh or the special keyword "all", or it can be a numeric value,
    representing one of these protocols or a different one. A prottocal name
    from `/etc/protocols` is also allowed. A "!" argument before the protocol
    inverts the test. The number zero is equivalent to "all". "all" will match
    with all protocols and is taken as default when this option is ommited.


-   `[!] -s address[/mask][,...]`: Source specification. Address can be either
    a network name, a hostname, a network IP address (with /mask), or a plain
    IP address. Hostname will be resolved once only, before the rule is
    submitted to the kernel. A "!" argument before the address specification
    inverts the sense of the address. Multiple address can be specified, but
    this will expand to multiple rules.

-   `[!] -d address[/mask][,...]`: Destination specification. (similar to `-s`
    option)

-   `-m match`: Specifies a match to use, that is, an extension module that
    test for a specific property.

-   `-j target`: Specifies the target of the rule; i.e., what to do if the
    packet matches it. The target can be a user-defined chain (other than the
    one this rule is in), one of the special builtin targets (ACCEPT, DROP,
    REJECT ...) which decide the fate of the packet immediately, or an
    extension. If this option is omitted in a rule, then matching the rule will
    have no effect on the packet's fate, but the counters on the rule will be
    increment.

== Examples ==

-   List all rules in `INPUT` chain of `filter` table.
    {{{
        sudo iptables -nvL INPUT
    }}}

-   List all rules in `INPUT` chain of `filter` table with line numbers.
    {{{
        sudo iptables -nvL INPUT --line-numbers
    }}}

-   Clear byte counters in `OUTPUT` chain of `filter table.
    {{{
        sudo iptables -Z OUTPUT
    }}}


== References ==

-   `man iptables`

-   `man iptables-extensions`

-   [[https://wiki.archlinux.org/index.php/iptables|archwiki iptables]]

-   [[https://netfilter.org/index.html|netfilter]]

-   [[https://www.frozentux.net/iptables-tutorial/iptables-tutorial.html|iptables tutorial]]

-   [[https://opensource.com/article/18/9/linux-iptables-firewalld|difference between iptables and firewalld]]
